{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Install: System Requirements",
      "type": "shell",
      "osx": {
        "command": "brew update && brew bundle install --file=config/system/requirements.macos.brew.rb"
      },
      "windows": {
        "command": "chocolatey install config/system/requirements.windows.choco.config"
      },
      "linux": {
        "command": "apt-get update && xargs -a config/system/requirements.linux.apt.txt apt-get install -y"
      }
    },
    {
      "label": "Conan: Create JUCE",
      "type": "shell",
      "problemMatcher": [
        "$gcc"
      ],
      "osx": {
        "command": "conan create juce-conan -pr config/conan/profiles/macos-armv8"
      },
      "windows": {
        "command": "conan create juce-conan -pr config/conan/profiles/windows-x86_64"
      },
      "linux": {
        "command": "conan create juce-conan -pr config/conan/profiles/linux-x86_64"
      }
    },
    {
      "label": "Conan: Install Requirements",
      "type": "shell",
      "problemMatcher": [
        "$gcc"
      ],
      "osx": {
        "command": "conan install . -pr config/conan/profiles/macos-armv8"
      },
      "windows": {
        "command": "conan install . -pr config/conan/profiles/windows-x86_64"
      },
      "linux": {
        "command": "conan install . -pr config/conan/profiles/linux-x86_64"
      }
    },
    {
      "label": "Conan: Build PeakEater",
      "type": "shell",
      "problemMatcher": [
        "$gcc"
      ],
      "options": {
        "env": {
          "MACOS_APPLE_IDENTITY": "",
          "MACOS_APPLE_ID": "",
          "MACOS_APPLE_PASSWORD": "",
          "MACOS_APPLE_TEAM_ID": ""
        }
      },
      "osx": {
        "command": "conan build . -pr config/conan/profiles/macos-armv8"
      },
      "windows": {
        "command": "conan build . -pr config/conan/profiles/windows-x86_64"
      },
      "linux": {
        "command": "conan build . -pr config/conan/profiles/linux-x86_64"
      }
    },
    {
      "label": "Test: Compilation",
      "type": "shell",
      "command": "python3 test/compilation.test.py"
    },
    {
      "label": "Test: DMG",
      "type": "shell",
      "osx": {
        "command": "python3 test/dmg.test.py"
      }
    },
    {
      "label": "Test: Pluginval",
      "type": "shell",
      "command": "python3 test/pluginval.test.py"
    },
    {
      "label": "Test: Run PeakEater Standalone",
      "type": "shell",
      "command": "${workspaceFolder}/build/PeakEater_artefacts/${input:build_type}/Standalone/PeakEater.app/Contents/MacOS/PeakEater"
    }
  ]
}